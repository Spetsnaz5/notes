## 索引目錄

- [簡介](#簡介)
- [跳脫字元](#跳脫字元)
- [錨點 (Anchors)](#錨點-anchors)
- [字元類別 (Character Classes)](#字元類別-character-classes)
- [量詞 (Quantifiers)](#量詞-quantifiers)
- [分組與捕獲 (Grouping & Capturing)](#分組與捕獲-grouping--capturing)
- [預查 (Lookarounds)](#預查-lookarounds)
- [修飾符 (Flags)](#修飾符-flags)
- [運算子優先級](#運算子優先級)
- [常見情境實戰範例 (Practical Examples)](#常見情境實戰範例-practical-examples)
- [實用資源](#實用資源)

---

## 簡介

正規表示法（Regular Expression）是用於描述字串模式的強大工具，可用於搜尋、取代、驗證字串。

---

## 跳脫字元 `\`
反斜線 `\` 用於跳脫特殊字元，使其被視為普通字元。例如，要匹配 `.` 字元，需要使用 `\.`; 要匹配 `\` 本身，則需使用 `\\`。

---

## 錨點 (Anchors)
錨點用於匹配字串中的特定位置，而不是字元本身。

- `^`：匹配字串的**開始**位置。
- `$`：匹配字串的**結束**位置。
- `\b`：匹配一個**單詞邊界**（單詞字元與非單詞字元之間的位置）。例如 `\bcat\b` 只會匹配獨立的單詞 "cat"。
- `\B`：匹配一個**非單詞邊界**。

---

## 字元類別 (Character Classes)
用於匹配某一類型的字元。

- `.`：匹配**除了換行符以外**的任何單一字元。
- `\d`：匹配任何一個**數字**字元。等同於 `[0-9]`。
- `\D`：匹配任何一個**非數字**字元。等同於 `[^0-9]`。
- `\w`：匹配任何一個**單詞字元**（字母、數字、底線）。等同於 `[A-Za-z0-9_]`。
- `\W`：匹配任何一個**非單詞字元**。等同於 `[^A-Za-z0-9_]`。
- `\s`：匹配任何一個**空白字元**（空格、Tab、換行符等）。
- `\S`：匹配任何一個**非空白字元**。

## 方括號表達式 (Bracket Expressions)
用於定義自訂的字元集合。

- `[abc]`：匹配集合中的**任何一個**字元（`a` 或 `b` 或 `c`）。
- `[^abc]`：**排除型**字元集合，匹配**除了** `a`, `b`, `c` 以外的任何字元。
- `[a-z]`：匹配 `a` 到 `z` 範圍內的任何一個小寫字母。

---

## 量詞 (Quantifiers)
量詞用於指定前面的元素必須出現的次數。

- `*`：匹配前一個元素 **0 次或多次**。等同於 `{0,}`。
- `+`：匹配前一個元素 **1 次或多次**。等同於 `{1,}`。
- `?`：匹配前一個元素 **0 次或 1 次**。等同於 `{0,1}`。
- `{n}`：精確匹配前一個元素 `n` 次。
- `{n,}`：匹配前一個元素**至少** `n` 次。
- `{n,m}`：匹配前一個元素**至少** `n` 次，**最多** `m` 次。

## 貪婪模式 vs. 非貪婪模式
預設情況下，量詞是「貪婪的」，會盡可能多地匹配字元。

- **範例 (貪婪)**：對於字串 `"<div>a</div><div>b</div>"`，正規表示式 `<div.*>` 會從第一個 `<div` 匹配到最後一個 `>`。

在量詞後面加上一個 `?` 可以將其變為「非貪婪模式」，使其盡可能少地匹配。

- **範例 (非貪婪)**：對於相同字串，`<div.*?>` 只會匹配到第一個 `</div>`。

---

## 分組與捕獲 (Grouping & Capturing)

- `(pattern)`
**捕獲型分組**：將多個字元組合成一個單元，並「捕獲」這次匹配的內容供後續使用（例如反向參照）。

- `(?:pattern)`
**非捕獲型分組**：只分組，不捕獲內容，效能稍好一些。

- `|`
**或 (Alternation)**：匹配 `|` 左邊或右邊的表達式。例如 `cat|dog` 可以匹配 "cat" 或 "dog"。

- `\num`
**反向參照 (Backreference)**：匹配第 `num` 個捕獲型分組所捕獲的內容。例如 `(\w)\1` 可以匹配連續兩個相同的單詞字元。

---

## 預查 (Lookarounds)
預查是一種特殊的零寬度斷言，它只匹配位置，不消耗字元。

- `(?=pattern)`：**正向肯定預查**。確保當前位置的右邊**能**匹配 `pattern`。例如 `Windows(?=95|XP)` 能匹配 "WindowsXP" 中的 "Windows"。
- `(?!pattern)`：**正向否定預查**。確保當前位置的右邊**不能**匹配 `pattern`。例如 `Windows(?!NT)` 能匹配 "WindowsXP" 中的 "Windows"。
- `(?<=pattern)`：**反向肯定預查**。確保當前位置的左邊**能**匹配 `pattern`。例如 `(?<=Mr\.)\s\w+` 能匹配 "Mr. Smith" 中的 " Smith"。
- `(?<!pattern)`：**反向否定預查**。確保當前位置的左邊**不能**匹配 `pattern`。

---

## 修飾符 (Flags)
修飾符也稱為模式，寫在正規表示式之外，用來影響整體的匹配行為。

- `g` (Global)：**全域**搜尋，找到所有匹配項，而不是在找到第一個後就停止。
- `i` (Ignore case)：**忽略大小寫**進行匹配。
- `m` (Multiline)：**多行**模式。使 `^` 和 `$` 能匹配每一行的開始和結束，而不僅僅是整個字串的開始和結束。
- `s` (dotAll)：允許 `.` 匹配換行符。

---

## 運算子優先級

| 優先權 | 運算子 |
| :--- | :--- |
| 最高 | `\` (跳脫字元) |
| 次高 | `()`, `(?:)`, `(?=)`, `[]` (分組與字元集合) |
| 中 | `*`, `+`, `?`, `{n}` (量詞) |
| 低 | `^`, `$`, `\b` (錨點與單詞邊界) |
| 次低 | `|` (或) |

---

## 常見情境實戰範例 (Practical Examples)
本章節展示如何組合使用基礎語法，來解決真實世界的問題。

## 驗證 Email
這是一個常用但很難完美的模式。以下是一個相對通用、能涵蓋大多數情況的版本。

```regex
^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$ 
```

- `^...$`：確保整個字串完全符合模式。
- `[a-zA-Z0-9._%+-]+`：匹配 `@` 前的使用者名稱部分。
- `@[a-zA-Z0-9.-]+`：匹配 `@` 之後的域名部分。
- `\.[a-zA-Z]{2,}`：匹配頂級域名（如 `.com`, `.net`），至少 2 個字母。

## 驗證 URL
匹配常見的 `http`, `https` 或 `ftp` 協定。

```regex
^(https?|ftp)://[^\s/$.?#].[^\s]*$ 
```

- `(https?|ftp)`：`s?` 表示 `s` 可有可無，所以能匹配 `http` 或 `https`。
- `://`：匹配協定後的分隔符。
- `[^\s/$.?#]`：確保域名開始不是一些無效字元。
- `.[^\s]*`：匹配域名和後續路徑。

## 擷取 HTML 標籤中的內容
從一個簡單的 HTML 標籤中抓取內容，這是「非貪婪量詞」和「捕獲型分組」的經典應用。

```regex
<h1>(.*?)</h1>
```

- `<h1>` 和 `</h1>`：直接匹配標籤本身。
- `(.*?)`：
    - `()`：建立一個捕獲組，讓我們能取得括號內的匹配結果。
    - `.`：匹配任何字元。
    - `*?`：非貪婪量詞，匹配 0 次或多次，但會盡可能少地匹配，直到遇到下一個 `</h1>` 為止。
- **注意**：正規表示法不適合用來解析複雜的 HTML 文件，應優先使用專業的 HTML 解析器。

## 密碼強度驗證
要求「長度至少為 8，且必須包含大寫字母、小寫字母和數字」。這是「預查」的最佳應用場景。

```regex
^(?=.*[a-z])(?=.*[A-Z])(?=.*\d).{8,}$ 
```

- `^...$`：確保整個密碼符合規則。
- `(?=.*[a-z])`：正向預查，確保字串中存在至少一個小寫字母。
- `(?=.*[A-Z])`：正向預查，確保字串中存在至少一個大寫字母。
- `(?=.*\d)`：正向預查，確保字串中存在至少一個數字。
- `. {8,}`：最後，匹配任何字元至少 8 次。三個預查條件都滿足後，這個部分才會成功匹配。

## 驗證台灣手機號碼
匹配 `09xx-xxxxxx` 或 `09xxxxxxxx` 格式。

```regex
^09\d{2}-?\d{6}$
```

- `^09`：以 `09` 開頭。
- `\d{2}`：接著是 2 個數字。
- `-?`：可以有一個可選的連字號 `-`。
- `\d{6}`：最後是 6 個數字。
- `$`：結尾。

---

## 實用資源

- [Regex Tester](https://www.regextester.com/)
